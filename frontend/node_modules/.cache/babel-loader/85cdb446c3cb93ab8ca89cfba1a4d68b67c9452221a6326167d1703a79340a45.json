{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\hamnu\\\\Desktop\\\\Web programming\\\\todo\\\\67011213-Todo\\\\frontend\\\\src\\\\components\\\\TodoList.js\",\n  _s = $RefreshSig$();\n// frontend/src/components/TodoList.js\nimport React, { useState, useEffect } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst API_URL = 'http://localhost:5001/api';\nfunction TodoList({\n  username,\n  onLogout\n}) {\n  _s();\n  const [todos, setTodos] = useState([]);\n  const [newTask, setNewTask] = useState('');\n  useEffect(() => {\n    fetchTodos();\n  }, [username]); // Refetch when username changes (e.g., after login)\n\n  // 1. READ: Fetch all todos for the current user\n  const fetchTodos = async () => {\n    try {\n      const response = await fetch(`${API_URL}/todos/${username}`);\n      if (!response.ok) {\n        console.error('Failed to fetch todos:', response.statusText);\n        return;\n      }\n      const data = await response.json();\n      setTodos(data);\n    } catch (err) {\n      console.error('Error fetching todos:', err);\n    }\n  };\n\n  // 2. CREATE: Add a new todo\n  const handleAddTodo = async e => {\n    e.preventDefault();\n    if (!newTask.trim()) return;\n    try {\n      const response = await fetch(`${API_URL}/todos`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          username,\n          task: newTask\n        })\n      });\n      if (!response.ok) {\n        console.error('Failed to add todo:', response.statusText);\n        return;\n      }\n      const newTodo = await response.json();\n      // Add the new item to the beginning of the list\n      setTodos([newTodo, ...todos]);\n      setNewTask('');\n    } catch (err) {\n      console.error('Error adding todo:', err);\n    }\n  };\n\n  // 3. UPDATE: Toggle the 'done' status\n  const handleToggleDone = async (id, currentDoneStatus) => {\n    const newDoneStatus = !currentDoneStatus;\n    try {\n      const response = await fetch(`${API_URL}/todos/${id}`, {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          done: newDoneStatus\n        })\n      });\n      if (!response.ok) {\n        console.error('Failed to update todo:', response.statusText);\n        return;\n      }\n\n      // Update the status in the local state immediately\n      setTodos(todos.map(todo => todo.id === id ? {\n        ...todo,\n        done: newDoneStatus\n      } : todo));\n    } catch (err) {\n      console.error('Error toggling done status:', err);\n    }\n  };\n\n  // 4. DELETE: Remove a todo item\n  const handleDeleteTodo = async id => {\n    try {\n      const response = await fetch(`${API_URL}/todos/${id}`, {\n        method: 'DELETE'\n      });\n      if (!response.ok) {\n        console.error('Failed to delete todo:', response.statusText);\n        return;\n      }\n\n      // Filter out the deleted item from the state\n      setTodos(todos.filter(todo => todo.id !== id));\n    } catch (err) {\n      console.error('Error deleting todo:', err);\n    }\n  };\n  const handleLogout = () => {\n    // Clear storage and trigger state change in App.js\n    localStorage.removeItem('todo_username');\n    onLogout();\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: [\"Todo List for: \", username]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleLogout,\n        children: \"Logout\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleAddTodo,\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        placeholder: \"New Task\",\n        value: newTask,\n        onChange: e => setNewTask(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        children: \"Add Task\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n      children: todos.map(todo => /*#__PURE__*/_jsxDEV(\"li\", {\n        style: {\n          textDecoration: todo.done ? 'line-through' : 'none'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"checkbox\",\n          checked: !!todo.done // Convert MySQL's 0/1 to boolean\n          ,\n          onChange: () => handleToggleDone(todo.id, todo.done)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 25\n        }, this), todo.task, /*#__PURE__*/_jsxDEV(\"small\", {\n          children: [\" (Updated: \", new Date(todo.updated).toLocaleString(), \")\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => handleDeleteTodo(todo.id),\n          style: {\n            marginLeft: '10px'\n          },\n          children: \"Delete\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 25\n        }, this)]\n      }, todo.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 21\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 107,\n    columnNumber: 9\n  }, this);\n}\n_s(TodoList, \"xh8MwZi0OG4TkOWtoGD228JrcEQ=\");\n_c = TodoList;\nexport default TodoList;\nvar _c;\n$RefreshReg$(_c, \"TodoList\");","map":{"version":3,"names":["React","useState","useEffect","jsxDEV","_jsxDEV","API_URL","TodoList","username","onLogout","_s","todos","setTodos","newTask","setNewTask","fetchTodos","response","fetch","ok","console","error","statusText","data","json","err","handleAddTodo","e","preventDefault","trim","method","headers","body","JSON","stringify","task","newTodo","handleToggleDone","id","currentDoneStatus","newDoneStatus","done","map","todo","handleDeleteTodo","filter","handleLogout","localStorage","removeItem","children","style","display","fileName","_jsxFileName","lineNumber","columnNumber","onClick","onSubmit","type","placeholder","value","onChange","target","textDecoration","checked","Date","updated","toLocaleString","marginLeft","_c","$RefreshReg$"],"sources":["C:/Users/hamnu/Desktop/Web programming/todo/67011213-Todo/frontend/src/components/TodoList.js"],"sourcesContent":["// frontend/src/components/TodoList.js\nimport React, { useState, useEffect } from 'react';\n\nconst API_URL = 'http://localhost:5001/api';\n\nfunction TodoList({ username, onLogout }) {\n    const [todos, setTodos] = useState([]);\n    const [newTask, setNewTask] = useState('');\n\n    useEffect(() => {\n        fetchTodos();\n    }, [username]); // Refetch when username changes (e.g., after login)\n\n    // 1. READ: Fetch all todos for the current user\n    const fetchTodos = async () => {\n        try {\n            const response = await fetch(`${API_URL}/todos/${username}`);\n            \n            if (!response.ok) {\n                console.error('Failed to fetch todos:', response.statusText);\n                return;\n            }\n\n            const data = await response.json();\n            setTodos(data);\n        } catch (err) {\n            console.error('Error fetching todos:', err);\n        }\n    };\n\n    // 2. CREATE: Add a new todo\n    const handleAddTodo = async (e) => {\n        e.preventDefault();\n        if (!newTask.trim()) return;\n\n        try {\n            const response = await fetch(`${API_URL}/todos`, {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({ username, task: newTask }),\n            });\n\n            if (!response.ok) {\n                console.error('Failed to add todo:', response.statusText);\n                return;\n            }\n\n            const newTodo = await response.json();\n            // Add the new item to the beginning of the list\n            setTodos([newTodo, ...todos]); \n            setNewTask('');\n        } catch (err) {\n            console.error('Error adding todo:', err);\n        }\n    };\n\n    // 3. UPDATE: Toggle the 'done' status\n    const handleToggleDone = async (id, currentDoneStatus) => {\n        const newDoneStatus = !currentDoneStatus;\n        try {\n            const response = await fetch(`${API_URL}/todos/${id}`, {\n                method: 'PUT',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({ done: newDoneStatus }),\n            });\n\n            if (!response.ok) {\n                console.error('Failed to update todo:', response.statusText);\n                return;\n            }\n\n            // Update the status in the local state immediately\n            setTodos(todos.map(todo => \n                todo.id === id ? { ...todo, done: newDoneStatus } : todo\n            ));\n        } catch (err) {\n            console.error('Error toggling done status:', err);\n        }\n    };\n\n    // 4. DELETE: Remove a todo item\n    const handleDeleteTodo = async (id) => {\n        try {\n            const response = await fetch(`${API_URL}/todos/${id}`, {\n                method: 'DELETE',\n            });\n            \n            if (!response.ok) {\n                 console.error('Failed to delete todo:', response.statusText);\n                return;\n            }\n\n            // Filter out the deleted item from the state\n            setTodos(todos.filter(todo => todo.id !== id));\n        } catch (err) {\n            console.error('Error deleting todo:', err);\n        }\n    };\n\n    const handleLogout = () => {\n        // Clear storage and trigger state change in App.js\n        localStorage.removeItem('todo_username');\n        onLogout();\n    };\n\n    return (\n        <div>\n            <div style={{ display: 'flex' }}>\n                <h2>Todo List for: {username}</h2>\n                <button onClick={handleLogout}>Logout</button>\n            </div>\n            \n            <form onSubmit={handleAddTodo}>\n                <input\n                    type=\"text\"\n                    placeholder=\"New Task\"\n                    value={newTask}\n                    onChange={(e) => setNewTask(e.target.value)}\n                />\n                <button type=\"submit\">Add Task</button>\n            </form>\n\n            <ul>\n                {todos.map(todo => (\n                    <li key={todo.id} style={{ textDecoration: todo.done ? 'line-through' : 'none' }}>\n                        <input\n                            type=\"checkbox\"\n                            checked={!!todo.done} // Convert MySQL's 0/1 to boolean\n                            onChange={() => handleToggleDone(todo.id, todo.done)}\n                        />\n                        {todo.task} \n                        <small> (Updated: {new Date(todo.updated).toLocaleString()})</small>\n                        <button onClick={() => handleDeleteTodo(todo.id)} style={{ marginLeft: '10px' }}>Delete</button>\n                    </li>\n                ))}\n            </ul>\n        </div>\n    );\n}\n\nexport default TodoList;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}